<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-deep to-blue-light p-4">
  <div class="w-full max-w-2xl">
    <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8">
      <div class="text-center mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-blue-deep mb-2">Completar Perfil</h1>
        <p class="text-gray-600 text-sm md:text-base">Por favor completa tus datos para continuar</p>
      </div>

      @if (errorMessage()) {
        <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <p class="text-red-600 text-sm">{{ errorMessage() }}</p>
        </div>
      }

      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <!-- Tipo de Documento y Número -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
          <div>
            <label for="tipoDocumento" class="block text-sm font-medium text-gray-700 mb-2">
              Tipo de Documento *
            </label>
            <p-select
              id="tipoDocumento"
              formControlName="tipoDocumento"
              [options]="tiposDocumento()"
              optionLabel="nombre"
              placeholder="Selecciona tipo"
              styleClass="w-full"
              [class.ng-invalid]="tipoDocumento?.invalid && tipoDocumento?.touched"
            />
            @if (tipoDocumento?.invalid && tipoDocumento?.touched) {
              <small class="text-red-500 mt-1 block">
                El tipo de documento es requerido
              </small>
            }
          </div>

          <div>
            <label for="nroDocumento" class="block text-sm font-medium text-gray-700 mb-2">
              Número de Documento *
            </label>
            <input
              id="nroDocumento"
              type="text"
              pInputText
              formControlName="nroDocumento"
              placeholder="12345678"
              class="w-full"
              [class.ng-invalid]="nroDocumento?.invalid && nroDocumento?.touched"
            />
            @if (nroDocumento?.invalid && nroDocumento?.touched) {
              <small class="text-red-500 mt-1 block">
                El número de documento es requerido
              </small>
            }
          </div>
        </div>

        <!-- Fecha de Nacimiento y Sexo -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
          <div>
            <label for="fechaNacimiento" class="block text-sm font-medium text-gray-700 mb-2">
              Fecha de Nacimiento *
            </label>
            <p-datepicker
              id="fechaNacimiento"
              formControlName="fechaNacimiento"
              [maxDate]="maxDate"
              dateFormat="dd/mm/yy"
              [showIcon]="true"
              placeholder="Selecciona fecha"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="fechaNacimiento?.invalid && fechaNacimiento?.touched"
            />
            @if (fechaNacimiento?.invalid && fechaNacimiento?.touched) {
              <small class="text-red-500 mt-1 block">
                La fecha de nacimiento es requerida
              </small>
            }
          </div>

          <div>
            <label for="sexo" class="block text-sm font-medium text-gray-700 mb-2">
              Sexo *
            </label>
            <p-select
              id="sexo"
              formControlName="sexo"
              [options]="opcionesSexo"
              optionLabel="label"
              optionValue="value"
              placeholder="Selecciona sexo"
              styleClass="w-full"
              [class.ng-invalid]="sexo?.invalid && sexo?.touched"
            />
            @if (sexo?.invalid && sexo?.touched) {
              <small class="text-red-500 mt-1 block">
                El sexo es requerido
              </small>
            }
          </div>
        </div>

        <!-- Teléfono -->
        <div class="mb-4 md:mb-6">
          <label for="telefono" class="block text-sm font-medium text-gray-700 mb-2">
            Teléfono *
          </label>
          <input
            id="telefono"
            type="tel"
            pInputText
            formControlName="telefono"
            placeholder="(011) 1234-5678"
            class="w-full"
            [class.ng-invalid]="telefono?.invalid && telefono?.touched"
          />
          @if (telefono?.invalid && telefono?.touched) {
            <small class="text-red-500 mt-1 block">
              El teléfono es requerido
            </small>
          }
        </div>

        <!-- Domicilio -->
        <div class="mb-4 md:mb-6">
          <label for="domicilio" class="block text-sm font-medium text-gray-700 mb-2">
            Domicilio *
          </label>
          <input
            id="domicilio"
            type="text"
            pInputText
            formControlName="domicilio"
            placeholder="Calle, Número, Piso, Depto"
            class="w-full"
            [class.ng-invalid]="domicilio?.invalid && domicilio?.touched"
          />
          @if (domicilio?.invalid && domicilio?.touched) {
            <small class="text-red-500 mt-1 block">
              El domicilio es requerido
            </small>
          }
        </div>

        <!-- Localidad -->
        <div class="mb-4 md:mb-6">
          <label for="localidad" class="block text-sm font-medium text-gray-700 mb-2">
            Localidad *
          </label>
          <p-autoComplete
            id="localidad"
            formControlName="localidad"
            [suggestions]="localidadesSugeridas()"
            (completeMethod)="buscarLocalidades($event)"
            optionLabel="localidad"
            [minLength]="2"
            placeholder="Buscar por localidad o código postal..."
            styleClass="w-full"
            inputStyleClass="w-full"
            [class.ng-invalid]="localidad?.invalid && localidad?.touched"
          >
            <ng-template #item let-loc>
              <div class="flex justify-between items-center w-full">
                <span>{{ loc.localidad }}, {{ loc.provincia }}</span>
                <small class="text-gray-500 ml-2">CP: {{ loc.codigopostal }}</small>
              </div>
            </ng-template>
          </p-autoComplete>
          @if (localidad?.invalid && localidad?.touched) {
            <small class="text-red-500 mt-1 block">
              La localidad es requerida
            </small>
          }
        </div>

        <!-- Condición IVA y CUIT -->
        @if (!esMayorDeEdad()) {
          <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
            <p class="text-blue-700 text-sm">
              Los campos de Condición IVA y CUIT son opcionales para menores de edad.
            </p>
          </div>
        }
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
          <div>
            <label for="condicionIva" class="block text-sm font-medium text-gray-700 mb-2">
              Condición IVA {{ esMayorDeEdad() ? '*' : '' }}
            </label>
            <p-select
              id="condicionIva"
              formControlName="condicionIva"
              [options]="condicionesIva()"
              optionLabel="nombre"
              placeholder="Selecciona condición"
              styleClass="w-full"
              [class.ng-invalid]="condicionIva?.invalid && condicionIva?.touched"
            />
            @if (condicionIva?.invalid && condicionIva?.touched && esMayorDeEdad()) {
              <small class="text-red-500 mt-1 block">
                La condición IVA es requerida
              </small>
            }
          </div>

          <div>
            <label for="cuit" class="block text-sm font-medium text-gray-700 mb-2">
              CUIT {{ esMayorDeEdad() ? '*' : '' }}
            </label>
            <p-inputMask
              id="cuit"
              formControlName="cuit"
              mask="99-99999999-9"
              placeholder="20-12345678-9"
              styleClass="w-full"
              [class.ng-invalid]="cuit?.invalid && cuit?.touched"
            />
            @if (cuit?.invalid && cuit?.touched) {
              <small class="text-red-500 mt-1 block">
                @if (cuit?.errors?.['required'] && esMayorDeEdad()) {
                  El CUIT es requerido
                }
                @if (cuit?.errors?.['pattern']) {
                  CUIT inválido (11 dígitos)
                }
              </small>
            }
          </div>
        </div>

        <!-- Contacto de Emergencia -->
        <div class="mb-6">
          <label for="contactoEmergencia" class="block text-sm font-medium text-gray-700 mb-2">
            Contacto de Emergencia *
          </label>
          <input
            id="contactoEmergencia"
            type="text"
            pInputText
            formControlName="contactoEmergencia"
            placeholder="Nombre y teléfono de contacto"
            class="w-full"
            [class.ng-invalid]="contactoEmergencia?.invalid && contactoEmergencia?.touched"
          />
          @if (contactoEmergencia?.invalid && contactoEmergencia?.touched) {
            <small class="text-red-500 mt-1 block">
              El contacto de emergencia es requerido
            </small>
          }
        </div>

        <!-- Botón Submit -->
        <button
          pButton
          type="submit"
          label="Guardar y Continuar"
          [loading]="loading()"
          [disabled]="loading()"
          class="w-full bg-gradient-orange text-white font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity"
        ></button>
      </form>
    </div>

    <div class="text-center mt-6">
      <p class="text-white text-xs md:text-sm">
        © 2026 Aliada Salud. Telemedicina de confianza.
      </p>
    </div>
  </div>
</div>
